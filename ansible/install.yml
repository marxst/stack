---
- name: base setup
  hosts: stack-nodes
  become: yes
  tags:
    - common

  roles:
    - role: base
      tags: ['base']
    - role: repositories
      tags: ['repositories']
    - role: firewall
      tags: ['firewall']


- name: set up controller node
  hosts: controller-nodes
  gather_facts: no
  become: yes
  tags:
    - controller

  roles:
    - role: memcached
      tags: ['memcached']
    - role: mariadb
      tags: ['mariadb']
    - role: rabbitmq
      tags: ['rabbitmq']
    - role: mongodb
      tags: ['mongodb']
    - role: os_common
      tags: ['os_common']
    - role: keystone
      tags: ['keystone']
    - role: cinder-controller
      tags: ['cinder-controller']
    - role: reboot
      tags: ['reboot']

- name: set up storage nodes
  hosts: storage-nodes
  gather_facts: no
  become: yes
  tags:
    - storage

  roles:
    - role: os_disksetup
      tags: ['os_disksetup']

# vim: ft=ansible
